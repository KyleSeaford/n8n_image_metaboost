services:
  - type: web
    name: n8n-service
    env: docker
    repo: https://github.com/Instro-AI-Solutions/n8n_image.git  # Use your repo URL
    branch: main  # Change to your default branch if needed
    plan: pro
    # Cannot change region and due to migration from free plan we are stuck on Ohio. However this shoudl be set to Frankfert when the opportunity arises
    # region: frankfurt
    # Optionally, specify the Dockerfile and context if not at root:
    # dockerfilePath: ./Dockerfile
    # buildContext: ./

    envVars:
      - key: N8N_ENCRYPTION_KEY
        generateValue: true
      - key: DB_TYPE
        value: postgresdb
      - key: DB_POSTGRESDB_DATABASE
        fromDatabase:
          name: n8n-db
          property: database
      - key: DB_POSTGRESDB_HOST
        fromDatabase:
          name: n8n-db
          property: host
      - key: DB_POSTGRESDB_PASSWORD
        fromDatabase:
          name: n8n-db
          property: password
      - key: DB_POSTGRESDB_USER
        fromDatabase:
          name: n8n-db
          property: user
      - key: NODE_FUNCTION_ALLOW_EXTERNAL
        value: langchain,openai,@pinecone-database/pinecone,@langchain/openai,@langchain/pinecone,@langchain/core
databases:
  - name: n8n-db
    plan: Basic-256mb
